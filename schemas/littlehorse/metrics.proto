syntax = "proto3";
package littlehorse;

import "google/protobuf/timestamp.proto";
import "object_id.proto";
import "common_enums.proto";

option go_package = ".;lhproto";
option java_multiple_files = true;
option java_package = "io.littlehorse.sdk.common.proto";
option csharp_namespace = "LittleHorse.Sdk.Common.Proto";

message MetricWindowId {
  oneof id {
    WfSpecId  wf_spec_id  = 1;
    TaskDefId task_def_id = 2;
    UserTaskDefId user_task_def_id = 3;
  }
  google.protobuf.Timestamp window_start = 5;
  MetricWindowType          metric_type  = 6;
}

message CountAndTiming {
  int32 count            = 1;
  int64 min_latency_ms   = 2;
  int64 max_latency_ms   = 3;
  int64 total_latency_ms = 4;
}

message MetricWindow {
  MetricWindowId              id      = 1;
  map<string, CountAndTiming> metrics = 2;
}

message ListWfMetricsRequest {
  WfSpecId                           wf_spec      = 1;
  optional google.protobuf.Timestamp window_start = 2;
  optional google.protobuf.Timestamp window_end   = 3;
}

message MetricsList {
  repeated MetricWindow windows = 1;
}